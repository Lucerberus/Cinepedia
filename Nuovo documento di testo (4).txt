successo=false;

 canDeactivate(): Promise<boolean> {
    if (!this.pagina_aperta || this.successo) {
      return Promise.resolve(true);
    }
    return this.dialogService.apriConfermaAnnulla();
  }


 ionViewWillEnter() {
  this.successo=false;
  this.pagina_aperta=true;


 next: (res) => {
      //in caso di successo visualizzo il messaggio di successo inviato dal server, appena l'utente clicca ok l'utente viene riportato alla pagina di home
      const messaggioSuccesso = res?.message || 'Film caricato!';
      // Conferma caricamento del film 
    this.dialogService.apriAvviso({messaggio:messaggioSuccesso, titolo:'Successo!'}).then(risposta => {
    if (risposta){
      this.successo=true;
       window.removeEventListener('beforeunload', this.avvisoModificheNonSalvate); //disabilito l'evento listener che mi chiedeva conferma prima di riaggiornare la pagina, tanto se sono qui è perchè l'utente ha correttamente effettuato l'operazione
    this.router.navigate(['/home']);